# Changes履歴保存機能 テストTODOリスト

## 概要
Changes履歴保存機能のテスト実施に必要なタスクのTODOリスト。

## 関連ドキュメント
- 設計書: [changes-history_design.md](../../TODOリスト/changes-history_design.md)
- 実装TODOリスト: [changes-history_TODO.md](../../TODOリスト/changes-history_TODO.md)
- テスト仕様書: [changes-history_test.md](./changes-history_test.md)

## Phase 1: テスト環境準備

### 1.1 テストスプレッドシートの準備
- [ ] テスト用スプレッドシートの作成
- [ ] 本番相当のシート構成を再現
- [ ] テスト用のマスタースプレッドシート準備
- [ ] アクセス権限の設定

### 1.2 テストデータの準備
- [ ] Changesシート用テストデータ（1件、50件、200件）
- [ ] ChangesHistory用の日付別テストデータ
- [ ] 日本語URLを含むテストデータ
- [ ] エッジケース用のデータ（特殊文字、長いURL等）

### 1.3 テストユーティリティの作成
- [ ] テストデータ生成関数の作成
- [ ] 日付操作用のヘルパー関数（過去日付の生成）
- [ ] アサーション用の関数
- [ ] パフォーマンス測定用の関数

## Phase 2: 機能テストの実施

### 2.1 履歴転写機能テスト (TS-001)
- [ ] TC-001: 基本的な転写機能
  - [ ] 単一データの転写確認
  - [ ] 複数データの転写確認
  - [ ] ChangesHistoryシートの自動作成確認
  - [ ] 各フィールドの値確認
- [ ] 空のChangesシートでの動作確認
- [ ] 日本語URLの転写確認
- [ ] エラーケースのテスト
  - [ ] シート作成権限なし
  - [ ] Changesシート不在

### 2.2 期限切れデータ削除テスト (TS-002)
- [ ] TC-003: 期限切れデータ削除
  - [ ] 5日経過データの削除確認
  - [ ] 境界値（4日23時間59分）の確認
  - [ ] 複数データの一括削除確認
- [ ] ChangesHistoryシート不在時の動作
- [ ] 不正データ形式での動作確認

### 2.3 runJudge統合テスト (TS-003)
- [ ] 初回実行時の動作確認
- [ ] 2回目実行時の転写確認
- [ ] TC-005: 6分制限との統合
  - [ ] 中断時の動作確認
  - [ ] 継続実行時の動作確認
- [ ] TC-004: エラー時の継続性
  - [ ] 転写エラーでの継続確認
  - [ ] 削除エラーでの継続確認

## Phase 3: 非機能テストの実施

### 3.1 パフォーマンステスト (TS-004)
- [ ] TC-002: 大量データ転写
  - [ ] 200件データの転写時間測定
  - [ ] メモリ使用量の確認
- [ ] 削除処理のパフォーマンス測定
  - [ ] 100件削除
  - [ ] 500件削除
  - [ ] 1000件削除
- [ ] runJudge全体への影響測定
  - [ ] 履歴機能なしでの実行時間
  - [ ] 履歴機能ありでの実行時間
  - [ ] 差分が1秒以内であることの確認

### 3.2 データ整合性テスト (TS-005)
- [ ] SavedAtの時刻精度確認
- [ ] ExpiresAtの計算確認
- [ ] RunIdの一意性確認
- [ ] 重複データ防止の確認

## Phase 4: 回帰テストの実施

### 4.1 既存機能への影響確認
- [ ] TC-006: 既存機能への無影響確認
  - [ ] バッチ処理の動作確認
  - [ ] 差分検出の精度確認
  - [ ] サーバー側処理の確認
  - [ ] UserLogの記録確認
- [ ] 既存のテストケースの再実行
  - [ ] 実行時間制限テスト
  - [ ] 大量データ処理テスト
  - [ ] エラーハンドリングテスト

### 4.2 エンドツーエンドテスト
- [ ] Chrome拡張機能からの完全なフロー確認
- [ ] 定期実行（トリガー）での動作確認
- [ ] 複数ユーザーでの同時実行確認

## Phase 5: テスト結果のまとめ

### 5.1 テスト結果の記録
- [ ] 各テストケースの実行結果記録
- [ ] パフォーマンス測定結果のまとめ
- [ ] 発見された問題の一覧作成
- [ ] テストエビデンスの保存

### 5.2 テストレポートの作成
- [ ] テスト結果サマリーの作成
- [ ] 合格基準との照合
- [ ] リスク評価の更新
- [ ] 改善提案の記載

## テスト実施の優先順位

1. **必須テスト**（リリース前に必須）
   - Phase 2.1, 2.2, 2.3の基本機能テスト
   - Phase 3.1のパフォーマンス基本測定
   - Phase 4.1の主要な回帰テスト

2. **推奨テスト**（品質向上のため推奨）
   - Phase 3.2のデータ整合性テスト
   - Phase 4.2のエンドツーエンドテスト
   - エッジケースのテスト

3. **オプションテスト**（余裕があれば実施）
   - 詳細なパフォーマンス分析
   - ストレステスト
   - セキュリティテスト

## テスト完了条件

- [ ] すべての必須テストが完了
- [ ] 致命的な不具合がない
- [ ] パフォーマンス基準を満たしている
- [ ] テスト結果が文書化されている
- [ ] ステークホルダーの承認

## 注意事項

1. **テストデータの管理**
   - 本番データは使用しない
   - テスト後はデータをクリーンアップ
   - テストデータは再現可能な形で保存

2. **並行作業の考慮**
   - 他の開発作業との干渉を避ける
   - テスト環境の独立性を保つ
   - バージョン管理を適切に行う

3. **問題発生時の対応**
   - 即座に開発チームに報告
   - 再現手順を明確に記録
   - ワークアラウンドを検討