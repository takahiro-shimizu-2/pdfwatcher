# PageSummary履歴管理拡張 テストTODOリスト

## 概要
PageSummaryの履歴管理を3世代から7日分へ拡張する機能のテスト実施TODOリストです。

**関連ドキュメント:**
- 設計書: `../../summary_history_extension_design.md`
- TODO: `../../TODOリスト/summary_history_extension_TODO.md`
- テスト仕様書: `summary_history_extension_test.md`

## 準備フェーズ

### TEST-PREP-001: テスト環境の準備
- [ ] テスト用Googleアカウントの準備
- [ ] テスト用マスタースプレッドシートの作成
- [ ] テスト用クライアントスプレッドシートの作成
- [ ] GASプロジェクトのコピー作成
- [ ] 必要な権限の設定

### TEST-PREP-002: テストデータの準備
- [ ] 3世代形式のサンプルデータ作成（10件）
- [ ] 3世代形式のサンプルデータ作成（100件）
- [ ] 3世代形式のサンプルデータ作成（1000件）
- [ ] 各種日付パターンのテストデータ作成
- [ ] 不正データパターンの作成

### TEST-PREP-003: テストスクリプトの準備
- [ ] 単体テスト用のテストスクリプト作成
- [ ] データ生成用のユーティリティスクリプト作成
- [ ] パフォーマンス測定用スクリプト作成
- [ ] 結果検証用スクリプト作成

## Phase 1: 単体テスト実施

### TEST-UT-001: PageSummaryモデルのテスト
- [ ] TypeScriptプロジェクトでのコンパイル確認
- [ ] 新しい型定義のインポートテスト
- [ ] プロパティアクセスのテスト
- [ ] テスト結果の記録

### TEST-UT-002: データ変換関数のテスト
- [ ] テストケース1: 完全な3世代データの変換
- [ ] テストケース2: run1のみのデータ変換
- [ ] テストケース3: run1,run2のみのデータ変換
- [ ] テストケース4: 空データの変換
- [ ] テストケース5: 不正形式データのエラー処理
- [ ] テスト結果の記録

### TEST-UT-003: 日付計算関数のテスト
- [ ] テストケース1: 当日データの判定
- [ ] テストケース2: 1-6日前データの判定
- [ ] テストケース3: 7日前データの判定
- [ ] テストケース4: 8日以上前データの判定
- [ ] テストケース5: 未来日付のエラー処理
- [ ] テスト結果の記録

### TEST-UT-004: 同一日付マージ関数のテスト
- [ ] テストケース1: 同日異時刻データのマージ
- [ ] テストケース2: 複数日データの処理
- [ ] テストケース3: 時刻なしデータの処理
- [ ] テスト結果の記録

## Phase 2: 統合テスト実施

### TEST-IT-001: PageSummary更新処理テスト
- [ ] シナリオ1: 新規ページでの7日間実行
  - [ ] Day1: 初回実行と確認
  - [ ] Day2-7: 日次実行と累積確認
  - [ ] Day8: 最古データ削除の確認
- [ ] シナリオ2: 同一日複数回実行
  - [ ] 1回目実行と記録
  - [ ] 2回目実行と上書き確認
  - [ ] 3回目実行と最新データ確認
- [ ] テスト結果の記録

### TEST-IT-002: データ移行テスト
- [ ] シナリオ1: フル3世代データの移行
  - [ ] 移行前データのバックアップ
  - [ ] 移行実行
  - [ ] 移行後データの検証
- [ ] シナリオ2: 部分データの移行
  - [ ] 各パターンでの移行実行
  - [ ] 結果検証
- [ ] シナリオ3: 移行後の追加実行
  - [ ] 新規データ追加
  - [ ] 正常動作確認
- [ ] テスト結果の記録

### TEST-IT-003: パフォーマンステスト
- [ ] 100件データでの測定
  - [ ] 更新処理時間
  - [ ] 取得処理時間
- [ ] 1000件データでの測定
  - [ ] 更新処理時間
  - [ ] 取得処理時間
  - [ ] メモリ使用量
- [ ] 従来版との比較
- [ ] テスト結果の記録

## Phase 3: E2Eテスト実施

### TEST-E2E-001: 7日間運用テスト
- [ ] Day1: 環境準備と初回実行
- [ ] Day2-7: 日次実行（自動化推奨）
- [ ] Day8: 削除動作確認
- [ ] 全期間のログ収集
- [ ] テスト結果の記録

### TEST-E2E-002: 本番相当環境での移行テスト
- [ ] 本番データのコピー準備
- [ ] バックアップ取得
- [ ] 移行実行
- [ ] 全データの検証
- [ ] ロールバック手順の確認
- [ ] テスト結果の記録

### TEST-E2E-003: クライアント影響確認
- [ ] IMPORTRANGEの動作確認
- [ ] 列表示の確認
- [ ] データ整合性の確認
- [ ] エラーメッセージの確認
- [ ] テスト結果の記録

## Phase 4: 無影響確認テスト

### TEST-NI-001: PageHistory無影響確認
- [ ] 実行前の動作記録
- [ ] 変更適用後の動作確認
- [ ] データ形式の比較
- [ ] テスト結果の記録

### TEST-NI-002: ChangesHistory無影響確認
- [ ] 転写処理の動作確認
- [ ] 5日削除の動作確認
- [ ] エラーハンドリング確認
- [ ] テスト結果の記録

### TEST-NI-003: PDF検出機能無影響確認
- [ ] PDF検出の動作確認
- [ ] 結果記録の確認
- [ ] パフォーマンス影響確認
- [ ] テスト結果の記録

## Phase 5: 異常系・境界値テスト

### TEST-ERR-001: エラー処理テスト
- [ ] TC-101: 不正日付データ処理
- [ ] TC-102: 列数不足時の自動拡張
- [ ] TC-103: 移行失敗時のロールバック
- [ ] TC-104: メモリ不足時の処理
- [ ] テスト結果の記録

### TEST-BND-001: 境界値テスト
- [ ] TC-201: 7日目データの保持確認
- [ ] TC-202: 8日目データの削除確認
- [ ] TC-203: 0件データの処理
- [ ] TC-204: 1000件データの処理時間
- [ ] テスト結果の記録

## Phase 6: 回帰テスト

### TEST-REG-001: 既存機能の回帰テスト
- [ ] 基本的なPDF検出フロー
- [ ] バッチ処理の正常動作
- [ ] エラー処理の動作
- [ ] ログ出力の確認
- [ ] テスト結果の記録

## Phase 7: 最終確認とドキュメント化

### TEST-DOC-001: テスト結果のドキュメント化
- [ ] 単体テスト結果のまとめ
- [ ] 統合テスト結果のまとめ
- [ ] E2Eテスト結果のまとめ
- [ ] パフォーマンステスト結果のグラフ化
- [ ] 問題点と対策のまとめ

### TEST-DOC-002: テストエビデンスの整理
- [ ] スクリーンショットの整理
- [ ] ログファイルの保存
- [ ] テストデータの保管
- [ ] 結果サマリーの作成

### TEST-DOC-003: リリース判定資料の作成
- [ ] 合格基準との照合
- [ ] 残存リスクの評価
- [ ] リリース可否の判定書作成
- [ ] 申し送り事項の作成

## 実施上の注意事項

1. **データのバックアップ**
   - 各テスト実施前に必ずバックアップを取得
   - 特に移行テストでは複数世代のバックアップを保持

2. **並行作業の禁止**
   - テスト実施中は他の開発作業を行わない
   - 特にスプレッドシートの構造変更は禁止

3. **ログの保存**
   - すべてのテスト実行ログを保存
   - エラーメッセージは完全な形で記録

4. **段階的実施**
   - 小規模データから開始し、徐々に規模を拡大
   - 問題発生時は即座に中断し原因調査

## 完了条件

- [ ] すべてのテストケースを実施
- [ ] すべての合格基準を満たす
- [ ] テスト結果ドキュメントの完成
- [ ] ステークホルダーへの報告完了
- [ ] リリース判定の承認取得