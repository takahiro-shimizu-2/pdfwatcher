# PageSummary 7世代拡張テストシナリオ（改訂版）

## ハッシュ値変更パターンの設計

### テストパターン一覧

1. **PDFとハッシュ両方が変更** - PDFの追加/削除/更新があり、ページ内容も変更
2. **PDFのみ変更** - PDFの追加/削除/更新があるが、ページ内容は同じ（ハッシュ値同一）
3. **ハッシュのみ変更** - PDFは同じだが、ページ内の文言等が変更
4. **変更なし** - PDFもハッシュも同一（変更として記録されない）

## 各実行回の詳細

### 実行1（初回）- 基準データ
```
page001: hash1001, PDF 3個
page002: hash2001, PDF 2個
page003: hash3001, PDF 4個
```

### 実行2（世代シフト開始）
```
page001: hash1002（変更）, PDF 4個（1更新、1追加）- PDFとハッシュ両方変更
page002: hash2001（同一）, PDF 2個（変更なし）- 変更として記録されない
page003: hash3002（変更）, PDF 4個（変更なし）- ハッシュのみ変更
page004: hash4001（新規）, PDF 1個 - 新規ページ
```

### 実行3（複数パターン）
```
page001: hash1002（同一）, PDF 4個（変更なし）- 変更として記録されない
page002: hash2002（変更）, PDF 3個（全更新、1追加）- PDFとハッシュ両方変更
page003: hash3003（変更）, PDF 2個（大幅削減）- PDFとハッシュ両方変更
page004: hash4002（変更）, PDF 3個（2追加）- PDFとハッシュ両方変更
```

### 実行4（継続的な変更）
```
page001: hash1003（変更）, PDF 5個（1追加）- PDFとハッシュ両方変更
page002: hash2002（同一）, PDF 3個（変更なし）- 変更として記録されない
page003: hash3004（変更）, PDF 4個（2追加）- PDFとハッシュ両方変更
page004: hash4003（変更）, PDF 3個（変更なし）- ハッシュのみ変更
page005: hash5001（新規）, PDF 1個 - 新規ページ
```

### 実行5（一部ページの削除）
```
page001: hash1004（変更）, PDF 0個（全削除）- PDFとハッシュ両方変更
page002: hash2003（変更）, PDF 4個（1追加）- PDFとハッシュ両方変更
page003: hash3004（同一）, PDF 4個（変更なし）- 変更として記録されない
page004: hash4004（変更）, PDF 3個（変更なし）- ハッシュのみ変更
page005: hash5002（変更）, PDF 3個（2追加）- PDFとハッシュ両方変更
```

### 実行6（再活性化）
```
page001: hash1005（変更）, PDF 2個（再活性化）- PDFとハッシュ両方変更
page002: hash2003（同一）, PDF 4個（変更なし）- 変更として記録されない
page003: hash3005（変更）, PDF 1個（全入れ替え）- PDFとハッシュ両方変更
page004: hash4005（変更）, PDF 5個（2追加）- PDFとハッシュ両方変更
page005: hash5002（同一）, PDF 3個（変更なし）- 変更として記録されない
```

### 実行7（7世代フル）
```
page001: hash1006（変更）, PDF 3個（1追加）- PDFとハッシュ両方変更
page002: hash2004（変更）, PDF 4個（変更なし）- ハッシュのみ変更
page003: hash3006（変更）, PDF 2個（1追加）- PDFとハッシュ両方変更
page004: hash4005（同一）, PDF 5個（変更なし）- 変更として記録されない
page005: hash5003（変更）, PDF 3個（変更なし）- ハッシュのみ変更
page006: hash6001（新規）, PDF 1個 - 新規ページ
```

### 実行8（最古データ削除確認）
```
page001: hash1007（変更）, PDF 1個（全入れ替え）- PDFとハッシュ両方変更
page002: hash2005（変更）, PDF 5個（全更新、1追加）- PDFとハッシュ両方変更
page003: hash3006（同一）, PDF 2個（変更なし）- 変更として記録されない
page004: hash4006（変更）, PDF 2個（全入れ替え）- PDFとハッシュ両方変更
page005: hash5004（変更）, PDF 4個（1追加）- PDFとハッシュ両方変更
page006: hash6002（変更）, PDF 2個（1追加）- PDFとハッシュ両方変更
page007: hash7001（新規）, PDF 2個 - 新規ページ
```

## 確認ポイント

### ハッシュ値による判定動作
- **ハッシュ値が変更**: 変更として記録され、世代が進む
- **ハッシュ値が同一**: 変更として記録されない（前回の状態を維持）

### 期待される記録パターン
- page001: 8回中7回変更（実行3は変更なし）
- page002: 8回中5回変更（実行2,3,5は変更なし）
- page003: 8回中6回変更（実行5,8は変更なし）
- page004: 8回中5回変更（実行3,7は変更なし）
- page005: 5回中3回変更（実行6は変更なし）

### 8回目実行後の世代確認
- 実行1の位置: 実行8のデータ
- 実行2の位置: 実行2のデータ（page001,page003,page004のみ）
- 実行3の位置: 実行3のデータ（page002,page003,page004のみ）
- 実行4の位置: 実行4のデータ（page001,page003,page005のみ）
- 実行5の位置: 実行5のデータ（page001,page002,page004,page005のみ）
- 実行6の位置: 実行6のデータ（page001,page003,page004のみ）
- 実行7の位置: 実行7のデータ（page001,page002,page003,page005,page006のみ）