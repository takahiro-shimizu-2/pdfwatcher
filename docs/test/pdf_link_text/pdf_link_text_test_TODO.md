# PDFリンクテキスト取得機能 テストTODOリスト

**関連設計書**: `../../pdf_link_text_design.md`  
**関連実装TODO**: `../../TODOリスト/pdf_link_text_TODO.md`  
**関連テスト仕様**: `pdf_link_text_test.md`

## テスト準備

### 環境構築
- [ ] Chrome最新版のインストール確認
- [ ] 開発版拡張機能のビルド環境準備
- [ ] Google Apps Scriptテスト環境の準備
- [ ] テスト用Webサーバーのセットアップ

### テストデータ作成
- [ ] 各テストケース用のHTMLファイル作成
  - [ ] TC-002: 基本的なリンク
  - [ ] TC-003: PDFサイズ情報付きリンク
  - [ ] TC-004: 空のリンク
  - [ ] TC-005: 画像のみのリンク
  - [ ] TC-006: 特殊文字を含むリンク
  - [ ] TC-007: 長大なテキスト
  - [ ] TC-008: 複数PDFリンク
  - [ ] TC-009: 埋め込み要素
- [ ] サンプルPDFファイルの準備
- [ ] パフォーマンステスト用の大量データ生成スクリプト作成

### テストツール準備
- [ ] Chrome DevToolsの使用方法確認
- [ ] メモリプロファイラの設定
- [ ] パフォーマンス測定ツールの準備
- [ ] テスト結果記録用スプレッドシートの作成

## Phase 1: 単体テスト（拡張機能）

### 基本機能テスト
- [ ] TC-001: 既存機能の無影響確認
  - [ ] 旧形式での出力確認
  - [ ] エラーが発生しないことの確認
- [ ] TC-002: 基本的なリンクテキスト取得
  - [ ] シンプルなリンクでのテスト
  - [ ] 期待値との比較
- [ ] TC-003: PDFサイズ情報を含むリンク
  - [ ] spanタグの除外確認
  - [ ] テキストのみ抽出の確認

### エッジケーステスト
- [ ] TC-004: 空のリンクテキスト
  - [ ] フォールバック動作の確認
  - [ ] ファイル名取得の確認
- [ ] TC-005: 画像のみのリンク
  - [ ] alt属性の取得確認
  - [ ] フォールバック動作の確認
- [ ] TC-006: 特殊文字を含むリンクテキスト
  - [ ] タブ文字のエスケープ確認
  - [ ] 改行文字のエスケープ確認
- [ ] TC-007: 長大なリンクテキスト
  - [ ] 100文字での切り詰め確認
  - [ ] 文字化けがないことの確認

### 複数要素テスト
- [ ] TC-008: 複数のPDFリンク
  - [ ] 全リンクの取得確認
  - [ ] 複数行形式の確認
- [ ] TC-009: 埋め込みPDF要素
  - [ ] embed要素からの取得
  - [ ] object要素からの取得
  - [ ] iframe要素からの取得

## Phase 2: 単体テスト（Google Apps Script）

### パーサーテスト
- [ ] TC-010: 新形式パーサーの基本動作
  - [ ] parseCurrentSheetV2の実装確認
  - [ ] 正しいグループ化の確認
- [ ] フォーマット判定テスト
  - [ ] 旧形式の判定
  - [ ] 新形式の判定
  - [ ] 混在時のエラーハンドリング

### データ処理テスト
- [ ] URL+Hashでのグループ化確認
- [ ] 重複データの処理確認
- [ ] 空行の処理確認

## Phase 3: 統合テスト

### エンドツーエンドテスト
- [ ] 拡張機能でのデータ取得
- [ ] クリップボードへのコピー
- [ ] スプレッドシートへの貼り付け
- [ ] GASでのパース処理
- [ ] データの整合性確認

### 互換性テスト
- [ ] CT-001: 既存データとの互換性
  - [ ] 旧形式データの処理
  - [ ] エラーが発生しないことの確認
- [ ] CT-002: フォーマット自動判定
  - [ ] 旧形式の正しい処理
  - [ ] 新形式の正しい処理

## Phase 4: パフォーマンステスト

### 処理時間測定
- [ ] PT-001: 処理時間の測定
  - [ ] テストデータの準備（100個のPDFリンク）
  - [ ] 抽出時間の測定
  - [ ] フォーマット生成時間の測定
  - [ ] 既存機能との比較
  - [ ] 10%以内の増加確認

### リソース使用量測定
- [ ] PT-002: メモリ使用量
  - [ ] 処理前のメモリ使用量記録
  - [ ] 処理後のメモリ使用量記録
  - [ ] 増加率の計算
  - [ ] 30%以内の増加確認

## Phase 5: セキュリティテスト

### 脆弱性テスト
- [ ] ST-001: XSS脆弱性テスト
  - [ ] スクリプトタグを含むテキスト
  - [ ] 実行されないことの確認
  - [ ] 適切なエスケープの確認
- [ ] ST-002: HTMLインジェクション
  - [ ] HTMLタグを含むテキスト
  - [ ] タグの除去/エスケープ確認
  - [ ] プレーンテキスト化の確認

### データ検証
- [ ] 入力値の妥当性確認
- [ ] 出力データのサニタイズ確認
- [ ] エラーメッセージの安全性確認

## Phase 6: 受け入れテスト

### ユーザビリティテスト
- [ ] UI/UXの確認
  - [ ] 操作の直感性
  - [ ] エラーメッセージの分かりやすさ
  - [ ] 処理時間の体感速度
- [ ] ドキュメントの確認
  - [ ] 使用方法の明確さ
  - [ ] トラブルシューティングの充実度

### 最終確認
- [ ] 全テストケースの合格確認
- [ ] パフォーマンス基準の達成確認
- [ ] セキュリティ要件の充足確認
- [ ] エラー率0.1%以下の確認

## テスト結果の記録

### 記録項目
- [ ] 各テストケースの実行日時
- [ ] 実行者
- [ ] 結果（合格/不合格）
- [ ] 不具合の詳細（発生した場合）
- [ ] 対応状況

### レポート作成
- [ ] テスト結果サマリーの作成
- [ ] 不具合一覧の作成
- [ ] パフォーマンス測定結果のグラフ化
- [ ] 最終テストレポートの作成

## リリース前チェックリスト

- [ ] すべてのテストケースが合格
- [ ] 重大な不具合がない
- [ ] パフォーマンス基準を満たしている
- [ ] セキュリティ脆弱性がない
- [ ] ドキュメントが最新化されている
- [ ] リリースノートが準備されている

## 注意事項

1. **テストの独立性**
   - 各テストケースは独立して実行可能であること
   - テスト間の依存関係を作らない

2. **再現性**
   - すべてのテストは再現可能であること
   - 環境依存の要素を最小化

3. **証跡の保存**
   - テスト結果のスクリーンショット
   - ログファイルの保存
   - パフォーマンス測定データの保存

4. **継続的なテスト**
   - 実装の進捗に応じて随時テスト実施
   - 回帰テストの実施