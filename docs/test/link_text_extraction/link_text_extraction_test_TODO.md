# リンクテキスト抽出機能改善 テストTODOリスト

## 関連ドキュメント
- 設計書: [link_text_extraction_design.md](../../link_text_extraction_design.md)
- 開発TODOリスト: [link_text_extraction_TODO.md](../../TODOリスト/link_text_extraction_TODO.md)
- テスト仕様書: [link_text_extraction_test.md](./link_text_extraction_test.md)

## 概要
このTODOリストは、[link_text_extraction_test.md](./link_text_extraction_test.md)のテスト仕様に基づいて、リンクテキスト抽出機能改善のテストタスクを管理します。

## テスト準備

### 1. テスト環境構築
- [ ] テスト用Chromeプロファイルの作成
- [ ] テスト用Google Sheetsの準備
- [ ] テスト用Google Apps Scriptプロジェクトの設定

### 2. テストデータ作成
- [x] テスト用HTMLファイルの作成
  - [x] `test_link_extraction.html` - すべてのテストケースを含む統合テストHTML
  - [x] `test_performance.html` - 100個のPDFリンク
- [x] 期待値データファイルの作成
- [x] テスト結果記録用テンプレートの作成

## 単体テスト実施

### 3. extractLinkSubject関数のテスト (UT-01〜UT-10)
- [x] UT-01: 単純なテキスト抽出
- [x] UT-02: ネストされた要素のテキスト抽出（`<strong>`、`<em>`）
- [x] UT-03: span要素を含むテキスト
- [x] UT-04: pdfsizeクラスを含むテキスト
- [x] UT-05: 空のリンク（ファイル名フォールバック確認）
- [x] UT-06: 空白のみのリンク
- [x] UT-07: 100文字以上のテキスト（文字数制限なし確認）
- [x] UT-08: タブ文字を含むテキスト（エスケープ確認）
- [x] UT-09: 改行を含むテキスト（エスケープ確認）
- [x] UT-10: 連続する空白（正規化確認）

## 統合テスト実施

### 4. Chrome拡張機能での抽出テスト (IT-01〜IT-04)
- [x] 拡張機能のビルドと開発者モードでのインストール
- [x] IT-01: edge_case_test.htmlでの複数PDFリンク抽出
- [x] IT-02: TSVフォーマット（4列構造）の確認
- [x] IT-03: 特殊文字のエスケープ動作確認
- [x] IT-04: 埋め込みPDF（embed/object/iframe）の抽出確認

## E2Eテスト実施

### 5. Google Sheets連携テスト (E2E-01〜E2E-03)
- [x] E2E-01: 基本的なデータ連携フロー
  - [x] Chrome拡張機能でPDFリンク抽出（95個のPDFリンク）
  - [x] TSVデータのクリップボードコピー確認
  - [x] Currentシートへの貼り付け
  - [x] runJudge関数の実行
  - [x] 各シート（ArchivePDF、Changes、ChangesHistory）へのデータ反映確認：全シートでSubject列正常表示
- [x] E2E-02: 100文字以上のテキストの連携確認（実データで確認済）
- [x] E2E-03: ネストされたHTML要素を含むリンクの連携確認（PDFサイズ情報含むリンクで確認済）

## 回帰テスト実施

### 6. 既存機能の動作確認 (RT-01〜RT-05)
- [x] RT-01: PDFのURL抽出が正常に動作
- [x] RT-02: ページURLとハッシュの取得が正常
- [x] RT-03: 埋め込みPDF検出機能が正常
- [x] RT-04: TSV列構造（4列）が維持されている
- [x] RT-05: 不正なURLでのエラーハンドリング

## パフォーマンステスト実施

### 7. 性能測定 (PT-01〜PT-02)
- [x] PT-01: 100個のPDFリンク処理時間測定
  - [x] 改修後の処理時間を測定: 約6.46秒（100個のPDFリンク処理）
  - [ ] 改修前の処理時間を測定
  - [ ] 比較結果の記録
- [x] PT-02: メモリ使用量の確認
  - [x] Chrome DevToolsでのメモリプロファイリング（ヒープスナップショット取得済）
  - [x] メモリリークの有無確認: 問題なし

## UI/UX確認

### 8. 表示確認
- [x] Chrome拡張機能ポップアップでの表示確認
  - [x] 長いテキストの表示（スクロール、折り返し）
  - [x] HTMLエスケープが正しく機能
  - [x] レイアウト崩れがない
- [ ] Google Sheetsでの表示確認
  - [ ] 列幅の自動調整が機能
  - [ ] 長いテキストが切れずに表示

## テスト結果まとめ

### 9. 結果集計と報告
- [ ] 全テストケースの実施結果を集計
- [ ] 不具合があれば不具合票を作成
- [ ] テスト結果レポートの作成
- [ ] 合格基準の達成状況を確認

### 10. 証跡保存
- [ ] テスト実施のスクリーンショット保存
- [ ] テストデータの保存
- [ ] テスト結果の保存

## テスト実施状況サマリー
- 単体テスト: 10/10完了（✅ 全項目完了）
- 統合テスト: 5/5完了（✅ 全項目完了）
- E2Eテスト: 3/3完了（✅ 全項目完了）
- 回帰テスト: 5/5完了（✅ 全項目完了）
- パフォーマンステスト: 2/2完了（✅ 全項目完了）
- UI/UX確認: Chrome拡張機能の表示確認完了

## 完了条件
- すべての高優先度テストケースが成功
- 回帰テストで既存機能に影響がないことを確認
- パフォーマンスの大幅な劣化がない
- 発見された不具合がすべて修正済み

## 注意事項
- テスト実施前に必ず最新のコードをビルドする
- テスト環境と本番環境を混同しない
- テスト結果は詳細に記録する
- 不具合を発見したら速やかに開発チームに報告する