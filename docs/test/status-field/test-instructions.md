# PDFステータスフィールド機能 実動作テスト手順書

## 準備作業

### 1. スプレッドシートの準備
1. 既存のPDF_Watcher_Masterスプレッドシートを開く
2. すべてのシートの内容をクリア（ヘッダー行も含めて削除）
3. 不要なシートがあれば削除

### 2. GASエディタの準備
1. PDF_Watcher_MasterのGASエディタを開く
2. master-gas/src/m-setup.jsのコードがデプロイされていることを確認

## テスト1: 新規インストール時の動作確認

### 手順
1. GASエディタで`setupMasterSpreadsheet()`関数を実行
2. 実行完了後、スプレッドシートに戻る
3. 以下を確認：
   - ArchivePDFシートが作成されているか
   - ArchivePDFシートの列数を確認（A〜E列の5列）
   - ヘッダーを確認：
     - A列: ページURL
     - B列: PDF URL
     - C列: 初回発見日時
     - D列: 最終確認日時
     - E列: ステータス

### 確認項目
- [ ] ArchivePDFシートが存在する
- [ ] 5列（A〜E）で構成されている
- [ ] ヘッダーが正しい順序で設定されている
- [ ] ヘッダーが太字になっている
- [ ] ヘッダーの背景色が設定されている（#f3f3f3）

## テスト3-1: 新規PDF追加テスト

### 準備
1. クライアント側スプレッドシートを用意
2. Chrome拡張機能でPDFを含むページをスキャン
3. Currentシートにデータを貼り付け

### 手順
1. クライアント側で`runJudge()`を実行
2. 実行完了後、PDF_Watcher_MasterのArchivePDFシートを確認
3. 新規追加されたPDFの行を確認

### 確認項目
- [ ] 新規PDFの行が追加されている
- [ ] E列（ステータス）が「ページ内に存在」になっている
- [ ] C列（初回発見日時）とD列（最終確認日時）が同じ日時
- [ ] 日時が現在時刻付近である

## テスト3-2: 既存PDF継続確認テスト

### 準備
1. テスト3-1で追加したPDFがArchivePDFシートに存在することを確認
2. D列（最終確認日時）の値をメモ

### 手順
1. 同じページを再度Chrome拡張機能でスキャン
2. Currentシートにデータを貼り付け
3. `runJudge()`を実行
4. ArchivePDFシートを確認

### 確認項目
- [ ] 既存PDFの行数が増えていない（重複していない）
- [ ] D列（最終確認日時）が更新されている
- [ ] C列（初回発見日時）は変更されていない
- [ ] E列（ステータス）が「ページ内に存在」のまま

## テスト3-3: PDF削除検出テスト

### 準備
1. ArchivePDFシートの既存PDFのD列（最終確認日時）をメモ
2. クライアント側のCurrentシートを確認

### 手順
1. Currentシートから一部のPDF行を削除
2. `runJudge()`を実行
3. ArchivePDFシートを確認

### 確認項目
- [ ] 削除したPDFのE列（ステータス）が「ページから削除」に変更
- [ ] 削除したPDFのD列（最終確認日時）が更新されていない
- [ ] 削除したPDFのC列（初回発見日時）は変更されていない

## テスト3-4: 削除後の再追加テスト

### 準備
1. テスト3-3で「ページから削除」になったPDFのURLを確認
2. そのPDFのD列（最終確認日時）をメモ

### 手順
1. Chrome拡張機能で同じPDFを含むページを再スキャン
2. Currentシートにデータを貼り付け（削除したPDFが含まれるように）
3. `runJudge()`を実行
4. ArchivePDFシートを確認

### 確認項目
- [ ] 再追加したPDFのE列（ステータス）が「ページ内に存在」に戻っている
- [ ] D列（最終確認日時）が新しい時刻に更新されている
- [ ] C列（初回発見日時）は最初の値のまま変更されていない

## テスト4: パフォーマンステスト

### 準備
1. 複数のPDFを含むページを用意（可能であれば10個以上）

### 手順
1. Chrome拡張機能でスキャン
2. `runJudge()`実行前に時刻を記録
3. `runJudge()`を実行
4. UserLogシートで実行時間を確認

### 確認項目
- [ ] 処理が正常に完了する
- [ ] UserLogシートに実行時間が記録されている
- [ ] 実行時間が妥当な範囲内（数秒〜数十秒）

## 結果記録
各テストの実施後、test-results.mdファイルに結果を記録してください。